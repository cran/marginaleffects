<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Standard Errors and Confidence Intervals</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>
<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Standard Errors and Confidence Intervals</h1>



<p>The code in this vignette requires version 0.5.0 of <code>marginaleffects</code> and 0.17.1 of <code>insight</code>.</p>
<p>Table of Contents:</p>
<ul>
<li>Robust standard errors</li>
<li>Sattherthwaite and Kenward-Roger corrections for mixed effects models</li>
<li>Delta method</li>
<li>Standard errors for average marginal effects and contrasts</li>
</ul>
<div id="robust-standard-errors" class="section level1">
<h1>Robust standard errors</h1>
<p>All the functions in the <code>marginaleffects</code> package can compute robust standard errors on the fly for any model type supported by <a href="https://sandwich.r-forge.r-project.org/">the <code>sandwich</code> package.</a> The <code>vcov</code> argument supports string shortcuts like <code>&quot;HC3&quot;</code>, a one-sided formula to request clustered standard errors, variance-covariance matrices, or functions which return such matrices. Here are a few examples.</p>
<p>Adjusted predictions with classical or heteroskedasticity-robust standard errors:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a><span class="kw">library</span>(marginaleffects)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a><span class="kw">library</span>(patchwork)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true"></a>mod &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>hp, <span class="dt">data =</span> mtcars)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true"></a>p &lt;-<span class="st"> </span><span class="kw">predictions</span>(mod)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true"></a><span class="kw">head</span>(p, <span class="dv">2</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true"></a><span class="co">#&gt;   rowid     type predicted std.error statistic       p.value conf.low</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true"></a><span class="co">#&gt; 1     1 response  22.59375 0.7772744  29.06792 9.135725e-186 21.00634</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true"></a><span class="co">#&gt; 2     2 response  22.59375 0.7772744  29.06792 9.135725e-186 21.00634</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true"></a><span class="co">#&gt;   conf.high mpg  hp</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true"></a><span class="co">#&gt; 1  24.18116  21 110</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true"></a><span class="co">#&gt; 2  24.18116  21 110</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true"></a>p &lt;-<span class="st"> </span><span class="kw">predictions</span>(mod, <span class="dt">vcov =</span> <span class="st">&quot;HC3&quot;</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true"></a><span class="kw">head</span>(p, <span class="dv">2</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true"></a><span class="co">#&gt;   rowid     type predicted std.error statistic       p.value conf.low</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true"></a><span class="co">#&gt; 1     1 response  22.59375 0.8629746  26.18125 4.345995e-151 20.83132</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true"></a><span class="co">#&gt; 2     2 response  22.59375 0.8629746  26.18125 4.345995e-151 20.83132</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true"></a><span class="co">#&gt;   conf.high mpg  hp</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true"></a><span class="co">#&gt; 1  24.35618  21 110</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true"></a><span class="co">#&gt; 2  24.35618  21 110</span></span></code></pre></div>
<p>Marginal effects with cluster-robust standard errors:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a>mfx &lt;-<span class="st"> </span><span class="kw">marginaleffects</span>(mod, <span class="dt">vcov =</span> <span class="op">~</span>cyl)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a><span class="kw">summary</span>(mfx)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true"></a><span class="co">#&gt;   Term   Effect Std. Error z value   Pr(&gt;|z|)   2.5 %   97.5 %</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true"></a><span class="co">#&gt; 1   hp -0.06823    0.01868  -3.653 0.00025909 -0.1048 -0.03162</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true"></a><span class="co">#&gt; Model type:  lm </span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true"></a><span class="co">#&gt; Prediction type:  response</span></span></code></pre></div>
<p>Comparing adjusted predictions with classical and robust standard errors:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a>p1 &lt;-<span class="st"> </span><span class="kw">plot_cap</span>(mod, <span class="dt">condition =</span> <span class="st">&quot;hp&quot;</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a>p2 &lt;-<span class="st"> </span><span class="kw">plot_cap</span>(mod, <span class="dt">condition =</span> <span class="st">&quot;hp&quot;</span>, <span class="dt">vcov =</span> <span class="st">&quot;HC3&quot;</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true"></a>p1 <span class="op">+</span><span class="st"> </span>p2</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /></p>
</div>
<div id="mixed-effects-models-satterthwaite-and-kenward-roger-corrections" class="section level1">
<h1>Mixed effects models: Satterthwaite and Kenward-Roger corrections</h1>
<p>For linear mixed effects models we can apply the Satterthwaite and Kenward-Roger corrections in the same way as above:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a><span class="kw">library</span>(marginaleffects)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a><span class="kw">library</span>(patchwork)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true"></a><span class="kw">library</span>(lme4)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true"></a>dat &lt;-<span class="st"> </span>mtcars</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true"></a>dat<span class="op">$</span>cyl &lt;-<span class="st"> </span><span class="kw">factor</span>(dat<span class="op">$</span>cyl)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true"></a>dat<span class="op">$</span>am &lt;-<span class="st"> </span><span class="kw">as.logical</span>(dat<span class="op">$</span>am)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true"></a>mod &lt;-<span class="st"> </span><span class="kw">lmer</span>(mpg <span class="op">~</span><span class="st"> </span>hp <span class="op">+</span><span class="st"> </span>am <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>cyl), <span class="dt">data =</span> dat)</span></code></pre></div>
<p>Marginal effects at the mean with classical standard errors and z-statistic:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a><span class="kw">marginaleffects</span>(mod, <span class="dt">newdata =</span> <span class="st">&quot;mean&quot;</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true"></a><span class="co">#&gt;   rowid     type term     contrast        dydx  std.error statistic</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true"></a><span class="co">#&gt; 1     1 response   hp        dY/dX -0.05184187 0.01146238 -4.522784</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true"></a><span class="co">#&gt; 2     1 response   am TRUE - FALSE  4.66614142 1.13425639  4.113833</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true"></a><span class="co">#&gt;        p.value    conf.low   conf.high       hp    am cyl    eps</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true"></a><span class="co">#&gt; 1 6.103158e-06 -0.07430773 -0.02937602 146.6875 FALSE   8 0.0283</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true"></a><span class="co">#&gt; 2 3.891429e-05  2.44303975  6.88924310 146.6875 FALSE   8     NA</span></span></code></pre></div>
<p>Marginal effects at the mean with Kenward-Roger adjusted variance-covariance and degrees of freedom:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="kw">marginaleffects</span>(mod,</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true"></a>                <span class="dt">newdata =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true"></a>                <span class="dt">vcov =</span> <span class="st">&quot;kenward-roger&quot;</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true"></a><span class="co">#&gt;   rowid     type term     contrast        dydx  std.error statistic</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true"></a><span class="co">#&gt; 1     1 response   hp        dY/dX -0.05184187 0.01518879 -3.413167</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true"></a><span class="co">#&gt; 2     1 response   am TRUE - FALSE  4.66614142 1.28244270  3.638479</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true"></a><span class="co">#&gt;      p.value   conf.low   conf.high       df       hp    am cyl</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true"></a><span class="co">#&gt; 1 0.09642979 -0.1305545  0.02687074 1.682575 146.6875 FALSE   8</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true"></a><span class="co">#&gt; 2 0.08741990 -1.9798401 11.31212296 1.682575 146.6875 FALSE   8</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true"></a><span class="co">#&gt;        mpg    eps</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true"></a><span class="co">#&gt; 1 20.09062 0.0283</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true"></a><span class="co">#&gt; 2 20.09062     NA</span></span></code></pre></div>
<p>We can use the same option in any of the package’s core functions, including:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a><span class="kw">plot_cap</span>(mod, <span class="dt">condition =</span> <span class="st">&quot;hp&quot;</span>, <span class="dt">vcov =</span> <span class="st">&quot;satterthwaite&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /></p>
</div>
<div id="delta-method" class="section level1">
<h1>Delta Method</h1>
<p>All the standard errors generated by the <code>marginaleffects()</code>, <code>comparisons()</code>, and <code>deltamethod()</code> functions of this package package are estimated using the delta method. Mathematical treatments of this method can be found in most statistics textbooks <a href="https://en.wikipedia.org/wiki/Delta_method">and on Wikipedia.</a> Roughly speaking, the delta method allows us to approximate the distribution of a smooth function of an asymptotically normal estimator.</p>
<p>Concretely, this allows us to generate standard errors around functions of a model’s coefficient estimates. Predictions, contrasts, marginal effects, and marginal means are functions of the coefficients, so we can use the delta method to estimate standard errors around all of those quantities. Since there are a lot of mathematical treatments available elsewhere, this vignette focuses on the “implementation” in <code>marginaleffects</code>.</p>
<p>Consider the case of the <code>marginalmeans()</code> function. When a user calls this function, they obtain a vector of marginal means. To estimate standard errors around this vector:</p>
<ol style="list-style-type: decimal">
<li>Take the numerical derivative of the marginal means vector with respect to the first coefficient in the model:
<ul>
<li>Compute marginal means with the original model: <span class="math inline">\(f(\beta)\)</span></li>
<li>Increment the first (and only the first) coefficient held inside the model object by a small amount, and compute marginal means again: <span class="math inline">\(f(\beta+\varepsilon)\)</span></li>
<li>Calculate: <span class="math inline">\(\frac{f(\beta+\varepsilon) - f(\beta)}{\varepsilon}\)</span></li>
</ul></li>
<li>Repeat step 1 for every coefficient in the model to construct a <span class="math inline">\(J\)</span> matrix.</li>
<li>Extract the variance-covariance matrix of the coefficient estimates: <span class="math inline">\(V\)</span></li>
<li>Standard errors are the square root of the diagonal of <span class="math inline">\(JVJ&#39;\)</span></li>
</ol>
<p>The main function used to compute standard errors in <code>marginaleffects</code> is here: <a href="https://github.com/vincentarelbundock/marginaleffects/blob/main/R/get_se_delta.R" class="uri">https://github.com/vincentarelbundock/marginaleffects/blob/main/R/get_se_delta.R</a></p>
</div>
<div id="standard-errors-and-intervals-for-marginaleffects-and-comparisons" class="section level1">
<h1>Standard errors and intervals for <code>marginaleffects()</code> and <code>comparisons()</code></h1>
<p>All standard errors for the <code>marginaleffects()</code> and <code>comparisons()</code> functions are computed using the delta method, as described above.</p>
<div id="standard-error-of-the-average-marginal-effect-or-contrast" class="section level2">
<h2>Standard Error of the Average Marginal Effect or Contrast</h2>
<p>The <code>summary()</code> and <code>tidy()</code> functions compute the average marginal effect (or contrast) when they are applied to an object produced by <code>marginaleffects()</code> (or <code>comparisons()</code>). This is done in 3 steps:</p>
<ol style="list-style-type: decimal">
<li>Extract the Jacobian used to compute unit-level standard errors.</li>
<li>Take the average of that Jacobian.</li>
<li>Estimate the standard error of the average marginal effect as the square root of the diagonal of J’VJ, where V is the variance-covariance matrix.</li>
</ol>
<p>As <a href="https://stats.stackexchange.com/a/331311/4874">explained succinctly on Stack Exchange:</a></p>
<blockquote>
<p>we want the variance of the Average Marginal Effect (AME) and hence our transformed function is: <span class="math inline">\(AME = \frac{1}{N} \sum_{i=1}^N g_i(x_i,\hat{\beta})\)</span> Then using the delta method we have <span class="math inline">\(Var \left( g(\hat{\beta}) \right) = J_g&#39; \Omega_{\hat{\beta}} J_g\)</span> where <span class="math inline">\(\Omega_{\hat{\beta}} = Var(\hat{\beta})\)</span> and <span class="math inline">\(J_g&#39; = \frac{\partial\left[\frac{1}{N}\sum_{i=1}^N g (x_i,\hat{\beta})\right]}{\partial \hat\beta} = \frac{1}{N}{\left[\sum_{i=1}^N \frac{\partial \left (g (x_i,\hat{\beta})\right)}{\partial \hat\beta}\right]}\)</span> Which justifies using the “average Jacobian” in the delta method to calculate variance of the AME.</p>
</blockquote>
<p>References:</p>
<ul>
<li>Dowd, Bryan E, William H Greene, and Edward C Norton. “Computation of Standard Errors.” Health Services Research 49, no. 2 (April 2014): 731–50. <a href="https://doi.org/10.1111/1475-6773.12122" class="uri">https://doi.org/10.1111/1475-6773.12122</a>.</li>
<li><a href="https://stats.stackexchange.com/questions/283831/delta-method-for-marginal-effects-of-generalized-linear-model?rq=1" class="uri">https://stats.stackexchange.com/questions/283831/delta-method-for-marginal-effects-of-generalized-linear-model?rq=1</a></li>
</ul>
</div>
</div>
<div id="standard-errors-and-intervals-for-marginalmeans" class="section level1">
<h1>Standard errors and intervals for <code>marginalmeans()</code></h1>
<p>The <code>marginalmeans()</code> function can compute the confidence intervals in two ways. If the following conditions hold:</p>
<ul>
<li>The user set: <code>type = &quot;response&quot;</code></li>
<li>The “link” type is supported for this model class</li>
<li>The <code>transform_post</code> argument is <code>NULL</code></li>
</ul>
<p>then <code>marginalmeans()</code> will first compute the marginal means on the link scale, and then back transform them using the inverse link function supplied by <code>insight::link_inverse(model)</code> function.</p>
<p>In all other cases, standard errors are computed using the delta method as described above.</p>
</div>
<div id="standard-errors-and-intervals-for-predictions" class="section level1">
<h1>Standard errors and intervals for <code>predictions()</code></h1>
<p>The <code>marginaleffects</code> package handles all calculations to compute standard errors, t statistics, p values, and confidence intervals for contrasts (<code>comparisons()</code>), marginal effects (<code>marginaleffects()</code>), and marginal means (<code>marginalmeans()</code>) functions.</p>
<p>When possible, however, the calculation of standard errors and confidence intervals for the output of <code>predictions()</code> is outsourced to the <a href="https://easystats.github.io/insight/"><code>insight</code> package.</a> The benefit of this is that, for many popular models, <code>insight</code> can compute confidence intervals via back-transformation, which gives them certain nice properties. For example, this ensures that confidence intervals around the predictions of a logistic regression model will remain in between 0 and 1.</p>
<p>When <code>insight</code> does not support a model, <code>marginaleffects</code> computes standard errors using the delta method, as described above. In those cases, confidence intervals are not created automatically, but users can easily compute them manually, as usual, by multiplying the standard error by a critical value. The standard errors thus estimated <a href="https://en.wikipedia.org/wiki/Delta_method">have desirable properties under normal assumptions.</a>, but since there is no back-transformation, it is not always advisable to use them to construct symmetric confidence intervals around adjusted predictions.</p>
</div>
<div id="bootstrap" class="section level1">
<h1>Bootstrap</h1>
<p>It is easy to use the bootstrap as an alternative strategy to compute standard errors and confidence intervals. Several <code>R</code> packages can help us achieve this, including the long-established <code>boot</code> package:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a><span class="kw">library</span>(boot)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true"></a>bootfun &lt;-<span class="st"> </span><span class="cf">function</span>(data, indices, ...) {</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true"></a>    d &lt;-<span class="st"> </span>data[indices, ]</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true"></a>    mod &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>am <span class="op">+</span><span class="st"> </span>hp <span class="op">+</span><span class="st"> </span><span class="kw">factor</span>(cyl), <span class="dt">data =</span> d)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true"></a>    cmp &lt;-<span class="st"> </span><span class="kw">comparisons</span>(mod, <span class="dt">newdata =</span> d, <span class="dt">vcov =</span> <span class="ot">FALSE</span>, <span class="dt">variables =</span> <span class="st">&quot;am&quot;</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true"></a>    <span class="kw">tidy</span>(cmp)<span class="op">$</span>estimate</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true"></a>}</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true"></a>b &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> mtcars, <span class="dt">statistic =</span> bootfun, <span class="dt">R =</span> <span class="dv">10</span>)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true"></a>b</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true"></a><span class="co">#&gt; ORDINARY NONPARAMETRIC BOOTSTRAP</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true"></a><span class="co">#&gt; Call:</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true"></a><span class="co">#&gt; boot(data = mtcars, statistic = bootfun, R = 10)</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true"></a><span class="co">#&gt; Bootstrap Statistics :</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true"></a><span class="co">#&gt;     original    bias    std. error</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true"></a><span class="co">#&gt; t1* 4.157856 0.2932568    1.395755</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true"></a><span class="kw">boot.ci</span>(b, <span class="dt">type =</span> <span class="st">&quot;perc&quot;</span>)</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true"></a><span class="co">#&gt; BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true"></a><span class="co">#&gt; Based on 10 bootstrap replicates</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true"></a><span class="co">#&gt; CALL : </span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true"></a><span class="co">#&gt; boot.ci(boot.out = b, type = &quot;perc&quot;)</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true"></a><span class="co">#&gt; Intervals : </span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true"></a><span class="co">#&gt; Level     Percentile     </span></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true"></a><span class="co">#&gt; 95%   ( 3.117,  6.975 )  </span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true"></a><span class="co">#&gt; Calculations and Intervals on Original Scale</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true"></a><span class="co">#&gt; Warning : Percentile Intervals used Extreme Quantiles</span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true"></a><span class="co">#&gt; Some percentile intervals may be unstable</span></span></code></pre></div>
<p>Note that, in the code above, we set <code>vcov=FALSE</code> to avoid computation of delta method standard errors and speed things up.</p>
<p>Compare to the delta method standard errors:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true"></a>mod &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>am <span class="op">+</span><span class="st"> </span>hp <span class="op">+</span><span class="st"> </span><span class="kw">factor</span>(cyl), <span class="dt">data =</span> mtcars)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true"></a><span class="kw">comparisons</span>(mod, <span class="dt">variables =</span> <span class="st">&quot;am&quot;</span>) <span class="op">|</span><span class="er">&gt;</span><span class="st"> </span><span class="kw">summary</span>()</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true"></a><span class="co">#&gt;   Term Contrast Effect Std. Error z value   Pr(&gt;|z|) 2.5 % 97.5 %</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true"></a><span class="co">#&gt; 1   am    1 - 0  4.158      1.257   3.309 0.00093648 1.695  6.621</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true"></a><span class="co">#&gt; Model type:  lm </span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true"></a><span class="co">#&gt; Prediction type:  response</span></span></code></pre></div>
</div>
<div id="bayesian-estimates-and-credible-intervals" class="section level1">
<h1>Bayesian estimates and credible intervals</h1>
<p><a href="https://vincentarelbundock.github.io/marginaleffects/reference/brms.html">See the <code>brms</code> vignette</a> for a discussion of bayesian estimates and credible intervals.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
